= Новая документация -- удобно и расширяемо

[#slide1]

Добрый день! Меня зовут Маркиев Владимир, я технический писатель в компании Docsvision. Сегодня расскажу про нашу новую онлайн документацию, её возможности и расширяемость.

Наверное, все желающие уже могли ознакомиться с новым сайтом документации, с поиском и навигацией. Как пользоваться сайтом, вы сможете разобраться без меня. Я подробнее расскажу, как устроена документация изнутри, и как она может быть и настроена под себя.

[#slide2]
== Устройство

Документация собирается при помощи Antora из исходных файлов в формате AsciiDoc. Antora -- это генератор статических сайтов для формата AsciiDoc. Файлы AsciiDoc и другие ресурсы хранятся в репозиториях GitHub, ссылки на которые указаны в конфигурационном файле Antora.

Запустить сборку сайта при помощи Antora можно одной командой, нужные ресурсы Antora найдёт сама.

[#slide3]
AsciiDoc - язык разметки, предоставляющий инструменты для форматирования, перекрёстных ссылок из одного раздела документации в другой и повторных использований. Разобраться в AsiiDoc несложно, к тому же его можно открыть в любом редакторе в любой файловой системе.

Чтобы разобраться в базовом синтаксисе, достаточно сравнить исходный текст с результатом на сайте.

Документация размещена в открытых репозиториях GitHub, что позволяет отслеживать изменения. Каждый желающий может сделать копию репозитория и изменить документацию под себя.

После выполнения команды Antora собирает сайт, самостоятельно получая требуемые исходные файлы AsciiDoc из репозиториев по указанным ссылкам.

[#slide4]
На более продвинутом уровне Antora использует проект пользовательского интерфейса -- веб-шаблоны, отвечающие за внешний вид сайта. Проект пользовательского интерфейса также хранится в отдельном https://github.com/Docsvision/antora-ui-default[репозитории на GitHub].

[#slide5]
На пользовательском интерфейсе остановлюсь чуть подробнее. Структура представлена на слайде. Совсем не обязательно использовать интерфейс по умолчанию, всё можно настроить под себя:

* Поменять стили, отредактировав файлы CSS
* Добавить собственные скрипты, меняющие поведение элементов на странице
* Изменить порядок элементов на странице и ссылки в шапке

Если вы знакомы с разработкой сайтов, вам будет легко понять принципы работы с проектом пользовательского интерфейса. Это как редактировать обычный HTML, только по окончании работы нужно выполнить команду, чтобы весь интерфейс собрался в один архив. Архив будет использован при запуске Antora.

[#slide6]
== Компоненты документации

Как я уже говорил, документация каждого модуля -- это отдельный репозиторий. Но главный репозиторий -- это antora-playbook. В нём расположен конфигурационный файл сайта -- файл `antora-playbook.yml`. Этот конфигурационный файл содержит инструкции, сообщающие Antora, как и из чего собирать сайт.

Внутри каждого такого источника располагается документация модулей нашей системы, каждая версия модуля располагается в отдельной ветке.

[#slide7]
Все репозитории документации объединяет наличие `Antora` в названии. На слайде можно увидеть, например, скриншот из профиля https://github.com/Docsvision?q=antora&type=all&language=&sort=[Docsvision на GitHub].

[#slide8]
Стандартная структура репозитория новой документации повторяет уже привычную структуру: руководство администратора, общая документация, руководство пользователя, программиста и т.д.

Вы можете сделать свою копию любого репозитория и изменить содержимое на любой странице сайта.

== Демо

Подробнее, как это делается я объясню в практической части.

Допустим, мы добавили расширение для грида в Web-клиенте -- новую кнопку на панель инструментов. Наша следующая задача -- добавить в документацию описание кнопки.

. Я уже сделал копию репозитория документации Web-клиента в своём личном профиле, поэтому я просто клонирую его на компьютер.
. AsciiDoc можно открыть в любом текстовом редакторе, но мы рекомендуем использовать бесплатную программу IntelliJ Idea Community Edition с плагином AsciiDoc.
. Вспоминаем, что грид -- это элемент управления, а значит нам нужна документация конструктора веб-разметок.
. Находим нужную папку. В данном случае полный путь будет такой: menu:Корень репозитория Web-клиента[Служебная папка "модули" > layouts -- то есть конструктор разметок > ctrl -- папка с документацией элементов управления > folderComponents -- группа элементов управления нового грида].
+
`WebC-Antora/modules/layouts/pages/ctrl/folderComponents/`
+
. Открываем файл `folderGrid_FolderGridToolbar.adoc`. На экране появится исходный AsciiDoc и превью.
. Мы хотим добавить ссылку на команду: "Новая команда". Сначала добавляем краткое описание: `Элемент управления "Новая команда" \image:buttons/new-command.png[] нужно добавить сюда.`
. Добавляем изображение в папку images/buttons при помощи Ctrl+X в окне проводника, и Ctrl+V в нужной папке.
. Далее добавим ссылку на новый раздел: `См. подробнее \xref:ctrl/folderComponents/new-command.adoc[]`.
. Видим ошибку о том, что нужный раздел не создан. Создадим раздел и добавим в него описание команды и иконку.
. Чтобы новый раздел отобразился в дереве навигации добавим его туда.
+
Можно найти нужный раздел в панели предварительного просмотра, но сориентироваться в большом файле сложно. Воспользуемся поиском по содержимому через CTRL+F.
+
. После редактирования необходимо отправить изменения в git, командами git add ., git commit, git push.
. Чтобы при сборке сайта изменения были получены из нового источника, подменим адрес репозитория в конфигурационном файле сайта на новый.
. Для этого клонируем репозиторий antora-playbook, откроем файл antora-playbook.yml и подменим адрес репозитория Docsvision на собственный.
. Снова переходим в консоль и запускам Antora командой `npx antora antora-playbook.yml`.
+
Если вы планировали только развернуть документацию на своём сервере и не собирались редактировать исходные файлы, то по сути вам нужно только выполнить эту команду.
+
. Когда Antora завершит сборку, файлы сайта можно будет открыть из браузера, они появятся в папке wwwroot.
. Посмотрим внесённые изменения на странице по адресу: `antora-playbook/wwwroot/, webclient, то есть название модуля, 5.5.17 -- его версия, папка layouts -- конструктор веб-разметок, папка ctrl -- элементы управления, folderComponents -- новый грид, folderGrid_FolderGridToolbar -- тулбар папки, index.html -- сама страница`

Как видим, на странице отобразилась вся добавленная информация. Нажатие на ссылку перенаправит на раздел с описанием новой команды. Здесь мы также видим иконку команды, её описание и заголовок. Также страница отображается в дереве навигации, значит мы сделали всё правильно.

== Ссылки

. Получить справку по синтаксису AsciiDoc можно на официальном сайте https://docs.asciidoctor.org/.
. Полная инструкция по работе с сайтом документации приведена в README https://github.com/Docsvision/antora-playbook[репозитория antora-playbook] в профиле Docsvision на GitHub.
. Инструкция по работе с пользовательским интерфейсом приведена в README https://github.com/Docsvision/antora-ui-default[репозитория пользовательского интерфейса на GitHub].

== Вопросики

Пара-тройка вопросов на конкурс
