= Новая документация — удобно и расширяемо

[#slide1]

Привет всем, меня зовут Маркиев Владимир, я технический писатель в компании Docsvision. Сегодня расскажу про нашу новую онлайн документацию, её возможности и расширяемость.

[#slide2]
== Устройство

Документация построена при помощи генератора статических сайтов Antora.

Я пишу документацию в формате AsciiDoc, сохраняю файлы в репозиториях GitHub, указываю на них ссылки в конфигурационном файле Antora и запускаю сборку.

У такого подхода есть преимущество — чтобы развернуть документацию у себя нужен только файл конфигурации, Antora сама найдёт репозитории с исходниками AsciiDoc.

[#slide3]
AsciiDoc предоставляет простой и функциональный синтаксис для форматирования, перекрёстных ссылок, повторных использований. Файлы формата AsciiDoc могут быть открыты в любом редакторе в любой файловой системе, а значит каждый может их редактировать. Чтобы разобраться в базовом синтаксисе, достаточно сравнить исходный текст с результатом на сайте.

[#slide4]
== Структура документации

Краткий итог сказанного выше: я пишу исходный код документации в формате AsciiDoc, отправляю файлы в GitHub, эстафету перехватывает Antora, она собирает файлы и создаёт сайт с документацией.

[#slide5]
На более глубоком уровне Antora использует проект пользовательского интерфейса -- веб-шаблоны, отвечающие за внешний вид сайта. Проект пользовательского интерфейса также хранится в https://github.com/Docsvision/antora-ui-default[репозитории на GitHub].

[#slide6]
На пользовательском интерфейсе остановлюсь чуть подробнее. Структура представлена на слайде. Необязательно использовать стили и структуру по умолчанию, всё можно настроить под себя:

* Поменять стили, отредактировав файлы CSS
* Добавить собственные скрипты, меняющие поведение элементов на странице
* Изменить порядок элементов на странице и ссылки в шапке

Если вы знакомы с разработкой сайтов, вам будет легко понять принципы работы с проектом пользовательского интерфейса. Это как редактировать обычный HTML, только по окончании работы нужно собрать архив, который будет использован при запуске Antora.

Инструкция по работе с пользовательским интерфейсом приведена в README https://github.com/Docsvision/antora-ui-default[репозитория на GitHub].

[#slide7]
== Компоненты сайта

Сайт документации состоит из нескольких компонентов. Основной компонент -- репозиторий antora-playbook. В нём расположен конфигурационный файл сайта -- файл `antora-playbook.yml`. Конфигурационный файл содержит инструкции, сообщающие Antora, как и из чего собирать сайт.

Antora поддерживает работу с множественными репозиториями, поэтому каждый раздел или модуль нашей новой документации -- это отдельный репозиторий. Каждый модуль нашей системы -- это компонент сайта, каждая версия модуля -- отдельная ветка в репозитории.

[#slide8]
Все репозитории документации объединяет наличие `Antora` в названии. Перейдите в профиль https://github.com/Docsvision?q=antora&type=all&language=&sort=[Docsvision на GitHub] и найдите репозитории со словом Antora в названии.

Вы можете сделать свою копию любого репозитория и изменить содержимое на любой странице сайта.

[#slide9]
Стандартная структура компонента с документацией повторяет привычную структуру документации: руководство администратора, общая документация, руководство пользователя, программиста и т.д.

== Демо

Подробнее, как это делается я объясню в практической части.

Допустим, мы добавили расширение для нового грида в Web-клиенте, новую кнопку в панель инструментов грида. Наша следующая задача — добавить в документацию описание нового элемента управления.

. Я уже сделал копию репозитория в своём личном профиле, поэтому я просто клонирую репозиторий Web-клиента.
. AsciiDoc можно открыть в любом текстовом редакторе, но мы рекомендуем использовать бесплатную программу IntelliJ Idea Community Edition с плагином AsciiDoc.
. Вспоминаем, что грид -- это элемент управления, а значит нам нужна документация конструктора разметок.
. Находим нужную папку. В данном случае полный путь будет такой: menu:Корень репозитория Web-клиента[Служебная папка "модули" > layouts -- то есть конструктор разметок > ctrl -- папка с документацией элементов управления > folderComponents -- группа элементов управления нового грида].
+
`WebC-Antora/modules/layouts/pages/ctrl/folderComponents/`
+
. Открываем файл `folderGrid_FolderGridToolbar.adoc`. На экране появляется исходный AsciiDoc И превью. Тулбар папки является контейнером, в который можно добавлять новые команды. Допустим, мы хотим добавить ссылку на нашу новую команду: "Новая команда". Сначала добавляем краткое описание команды: `Элемент управления "Новая команда" \image:buttons/new-command.png[] нужно добавить сюда.`
. Далее добавим ссылку на новый раздел: `См. подробнее \xref:ctrl/folderComponents/new-command.adoc[]`.
. Получить справку по синтаксису AsciiDoc можно на официальном сайте https://docs.asciidoctor.org/.
. После редактирования необходимо отправить изменения в git, командами git add ., git commit, git push.
. Чтобы завершить редактирование, добавим новый адрес репозитория в конфигурационный файл сайта.
. Для этого клонируем репозиторий antora-playbook, откроем файл antora-playbook.yml и подменим адрес репозитория Docsvision на собственный.
. Снова переходим в консоль и запускам Antora командой `npx antora antora-playbook.yml`.
. Посмотрим изменения на странице сайта из браузера: `antora-playbook/wwwroot/webclient/5.5.17/layouts/ctrl/folderComponents/folderGrid_FolderGridToolbar/index.html`
. Полная инструкция по работе с сайтом документации приведена в README https://github.com/Docsvision/antora-playbook[репозитория antora-playbook] в профиле Docsvision на GitHub.
. Если редактировать исходную документацию не требуется, можно ограничиться клонированием репозитория antora-playbook и выполнением команды запуска Antora.

== Вопросики

Пара-тройка вопросов на конкурс
